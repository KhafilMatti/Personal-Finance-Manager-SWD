<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Budget – {{ budget.category }}</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
</head>
<body class="bg-light">

<nav class="navbar navbar-light bg-white border-bottom mb-4 px-4">
    <a class="navbar-brand mb-0 h4" href="{{ url_for('dashboard') }}">
        ← Back to Dashboard
    </a>
    <div>
        <span class="me-3">
          {{ user.username }}
          {% if session.get("role") %} ({{ session["role"] }}){% endif %}
        </span>
        <a href="{{ url_for('logout') }}" class="btn btn-outline-danger btn-sm">Logout</a>
    </div>
</nav>

<div class="container mb-5">
    <div class="row mb-4">
        <div class="col-md-6 mb-3">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">{{ budget.category }} Budget</h5>
                    <p class="mb-1">Limit: <strong>£{{ "%.2f"|format(budget.limit) }}</strong></p>
                    <p class="mb-1">Spent: <strong>£{{ "%.2f"|format(total_spent) }}</strong></p>
                    <p class="mb-0">
                        Remaining:
                        {% if remaining >= 0 %}
                          <strong class="text-success">£{{ "%.2f"|format(remaining) }}</strong>
                        {% else %}
                          <strong class="text-danger">-£{{ "%.2f"|format(remaining|abs) }}</strong>
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
    </div>

    <h5 class="mb-3">Transactions in this budget</h5>

    {% if transactions %}
    <table class="table table-sm align-middle">
        <thead>
            <tr>
                <th>ID</th>
                <th>Category</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody>
        {% for t in transactions %}
            <tr>
                <td>{{ t.id }}</td>
                <td>{{ t.category }}</td>
                <td>£{{ "%.2f"|format(t.amount) }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
        <p class="text-muted">No transactions yet for this budget.</p>
    {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
